// _Dropdown.less
// v1.0
// Last Updated : 2011-11-28 16:45
// Copyright : SID Presse | 2006-2008 Live Web Institute (http://www.lwis.net) | Stu Nicholls (http://www.cssplay.co.uk)
// Author : Arnaud GAUDIN

//OPTIMISATION : n'inclure que les utilitaires réellement utilisés dans ce widget (cf dossiers Utilities)
@import "_templates/baseTheme/_framework/SPLessCss/Utilities/Grids/_GridsUtils.less";
@import "_templates/baseTheme/_framework/SPLessCss/Utilities/Css3/_Css3Transition.less";

//Compatibilité navigateurs : 	Windows: IE6+, Opera7+, Firefox1+
//								Mac OS: Safari2+, Firefox2+

//CALCUL DES DIMENSIONS POUR LE MENU
//nombre de colonnes pour le contenu des cellules
@menuDropdownCols: 3;

//Initialisation style de base du menu
ul.dropdown { &, li, ul { list-style: none; margin: 0; padding: 0; } }

ul.dropdown {
	
	//################################################
	//########### 1 CONFIGURATION DE BASE ############
	//################################################
	
	//définitions de la taille de police par défaut
	font-size: @fontGlobalSize;
	line-height: @gridBaseline;
	
	//gestion profondeur de placement
	position: relative;
	z-index: 100;
	float: left;
	
	//rajout border-right invisible pour superposition
	ul { border-right: 1px solid transparent; }
	
	//gestion placement vertical
	#dm_sidebar_left & {
		float: left;
		//rajout border-right invisible pour superposition
		&, & ul { border-right: 1px solid transparent; }
	}
	
	#dm_sidebar_right & {
		float: right;
		//rajout border-left invisible pour superposition
		&, & ul { border-left: 1px solid transparent; border-right: 0; }
	}
	
	ul {
		position: absolute;
		z-index: 150;
		top: 100%;
		left: 0;
		
		//gestion placement vertical
		#dm_sidebar_left &, #dm_sidebar_right & { top: 0; }
		//débuggage comportements opposés
		#dm_sidebar_left & { right: auto !important; }
		#dm_sidebar_right & { left: auto !important; }
		
		ul {
			top: 0;
			left: 100%;
			z-index: 200;
		}
	}
	
	li {
		position: relative;
		float: left;
		line-height: @gridBaseline;
		vertical-align: middle;
		zoom: 1;
		li { float: none; }
		
		//gestion placement vertical
		#dm_sidebar_left &, #dm_sidebar_right & { float: none; }
		#dm_sidebar_left & { text-align: left; }
		#dm_sidebar_right & { text-align: right; }
	}
	
	//positionnement des liens
	.link { position: relative; display:block; z-index: 250; }
	
	//on configure le tableau afin qu'il n'entre pas en compte dans le design sous IE - requis par IE
	table { position:absolute; top:0; left:0; border-collapse:collapse; }
	
	
	//################################################
	//################# 2 DIMENSIONS #################
	//################################################
	
	//NIVEAU 0 : largeur automatique
	li { width: auto; }
	
	//gestion placement vertical
	#dm_sidebar_left & {
		//largeur en fonction de la zone
		@gridWidth(@gridCol_SidebarLeft; 0);
	}
	#dm_sidebar_right & {
		//largeur en fonction de la zone
		@gridWidth(@gridCol_SidebarRight; 0);
	}
	
	//NIVEAU 1 et + : largeur fixe
	ul {
		@gridWidth(@menuDropdownCols; (@gridGutter*-1));
		
		#dm_sidebar_left & {
			//décalage manuel (largeur niveau supérieur ; décalage supérieur)
			@gridAbsoluteLeft(@gridCol_SidebarLeft; 0);
			//décalage manuel (largeur niveau supérieur ; décalage supérieur)
			ul { @gridAbsoluteLeft(@menuDropdownCols; (@gridGutter*-1)); }
		}
		
		#dm_sidebar_right & {
			//décalage manuel (largeur niveau supérieur ; décalage supérieur)
			@gridAbsoluteRight(@gridCol_SidebarRight; 0);
			//décalage manuel (largeur niveau supérieur ; décalage supérieur)
			ul { @gridAbsoluteRight(@menuDropdownCols; (@gridGutter*-1)); }
		}
	}
	
	
	//################################################
	//################# 2 AFFICHAGE ##################
	//################################################
	
	ul {
		visibility: hidden;
		.csstransitions.opacity & {
			opacity: 0;
			//@transitionCompress(visibility, opacity; 0, .2s; ease-out; .2s, 0);
			//safari ne supporte pas la déclaration séparé complète différencié en pseudo classe
			//@transition(visibility, opacity; 0, .2s; ease-out; .2s, 0);
			@transitionProperty(visibility, opacity);
			@transitionDuration(0, .2s);
			@transitionFunction(ease-out);
			@transitionDelay(.2s, 0);
		}
	}
	
	//gestion du debug
	//#dm_sidebar_left & > li:nth-child(2) {
	//#dm_sidebar_right & > li:nth-child(1) {
	//#dm_custom_top & > li:nth-child(2) {
	//	& > ul,
	//	& > ul > li:nth-child(1) > ul,
	//	& > ul > li:nth-child(1) > ul > li:nth-child(2) > ul {
	//		opacity: 1 !important;
	//		visibility: visible !important;
	//	}
	//}
	
	//GESTION DES APPARITIONS SUR 8 NIVEAUX
	:hover ul ul,
	:hover ul :hover ul ul,
	:hover ul :hover ul :hover ul ul,
	:hover ul :hover ul :hover ul :hover ul ul,
	:hover ul :hover ul :hover ul :hover ul :hover ul ul,
	:hover ul :hover ul :hover ul :hover ul :hover ul :hover ul ul,
	:hover ul :hover ul :hover ul :hover ul :hover ul :hover ul :hover ul ul,
	:hover ul :hover ul :hover ul :hover ul :hover ul :hover ul :hover ul :hover ul ul {
		visibility: hidden;
		.csstransitions.opacity & {
			opacity: 0;
			@transitionDelay(.2s, 0);
		}
	}
	
	:hover ul,
	:hover ul :hover ul,
	:hover ul :hover ul :hover ul,
	:hover ul :hover ul :hover ul :hover ul,
	:hover ul :hover ul :hover ul :hover ul :hover ul,
	:hover ul :hover ul :hover ul :hover ul :hover ul :hover ul,
	:hover ul :hover ul :hover ul :hover ul :hover ul :hover ul :hover ul,
	:hover ul :hover ul :hover ul :hover ul :hover ul :hover ul :hover ul :hover ul {
		visibility: visible;
		.csstransitions.opacity & {
			opacity: 1;
			@transitionDelay(0, 0);
		}
	}
	
	//Ancienne notation répétitive
	/*
	:hover ul {
		visibility: visible;
		ul { visibility: hidden; }
		:hover ul {
			visibility:visible;
			ul { visibility: hidden; }
			:hover ul {
				visibility:visible;
				ul { visibility: hidden; }
				:hover ul {
					visibility:visible;
					ul { visibility: hidden; }
					:hover ul {
						visibility:visible;
						ul { visibility: hidden; }
						//ZONE D'INSERTION DE NIVEAUX SUPPLÉMENTAIRES
					}
				}
			}
		}
	}
	*/
}