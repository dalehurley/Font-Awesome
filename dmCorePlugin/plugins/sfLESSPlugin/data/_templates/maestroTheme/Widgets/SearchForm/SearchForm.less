// _SearchForm.less
// v1.5
// Last Updated : 2012-03-27 16:45
// Copyright : SID Presse
// Author : Arnaud GAUDIN

//Config par défaut des widgets du template
@import "_templates/maestroTheme/Widgets/_Widgets.less";

//OPTIMISATION : n'inclure que les utilitaires réellement utilisés dans ce widget (cf dossiers Utilities)
@import "_framework/SPLessCss/Utilities/Css3/_Css3Border.less";
@import "_framework/SPLessCss/Utilities/Css3/_Css3Shadow.less";
@import "_framework/SPLessCss/Utilities/Css3/_Css3Transition.less";
@import "_framework/SPLessCss/Utilities/Grids/_GridsUtils.less";
@import "_framework/SPLessCss/Utilities/Sprites/_SpritesUtils.less";

//Importation de la mise en page par défaut du widget
@import "_framework/SPLessCss/Widgets/SearchForm/_SearchForm.less";

.dm_widget.search_form {
	.isLess & { background-color: fadeout(#BBF2F2, 75%); }

	//placement dans le header
	#dm_header & {
		position: absolute;
		right: 0;
		bottom: @gridBaseline;
	}

	//placement dans la zone située sous le header
	#dm_custom_top & {
		float: left;
		margin-bottom: @gridBaseline/2;
	}

	//calcul dimension en colonnes du formulaire
	@formCol: floor((@gridCol - @gridCol_SidebarLeft)/2);
	
	.dm_widget_inner {
		.isLess & { background-color: fadeout(#8ED4D4, 75%); }

		// //stylage lorsque placé dans le header
		// #dm_header & {
		// 	//calcul dimension en colonnes du formulaire
		// 	@formCol: floor((@gridCol - @gridCol_SidebarLeft)/2);

		// 	//placement formulaire
		// 	form {
		// 		//application largeur (soustraction bordure)
		// 		@gridWidth(@formCol; 2px);
		// 	}

		// 	//champ de saisie de la recherche
		// 	.query {
		// 		//application largeur
		// 		@gridWidth(@formCol; (@offS*2 + 2px));
		// 		//ajout du décalage à gauche si pseudo élément affiché
		// 		.generatedcontent & {
		// 			@gridWidth(@formCol; (@offS*3 + @spriteFormat_S + 2px));
		// 			&:focus{
		// 				@gridWidth(@formCol; (@offS*2 + 2px));
		// 			}
		// 		}
		// 	}
		// }

		// //stylage lorsque placé dans la zone située sous le header
		// #dm_custom_top & {
		// 	//placement formulaire
		// 	form {
		// 		//application largeur (soustraction bordure)
		// 		@gridWidth(@gridCol_SidebarLeft; 2px);
		// 	}

		// 	//champ de saisie de la recherche
		// 	.query {
		// 		//application largeur
		// 		@gridWidth(@gridCol_SidebarLeft; (@offS*2 + 2px));
		// 		//ajout du décalage à gauche si pseudo élément affiché
		// 		.generatedcontent & {
		// 			@gridWidth(@gridCol_SidebarLeft; (@offS*3 + @spriteFormat_S + 2px));
		// 			&:focus{
		// 				@gridWidth(@gridCol_SidebarLeft; (@offS*2 + 2px));
		// 			}
		// 		}
		// 	}
		// }
		
		//stylage lorsque placé dans le header ou dans la zone située sous ce dernier
		#dm_header &, #dm_custom_top &  {

			//placement formulaire
			form {
				position: relative;
				background-color: @colorCouleur2ClairSup;
				.rgba & { background-color: fadeout(@colorCouleur2ClairSup, 20%); }

				//application largeur (soustraction bordure)
				@gridWidth(@formCol; @offS*2);
				// overflow: hidden;
				margin: 0;
				padding: 0;

				//ajout de la bordure arrondie
				// @borderRadiusCompress(@offL);

				//Ajout transition sur la couleur de fond
				// .csstransitions & {
				// 	@transitionCompress(all; .2s; ease-out; 0s);
				// }

				//ajout de la sprite avec l'icône de recherche
				&:before {
					background-color: red;
					position: absolute;
					display: block;
					visibility: visible;
					z-index: 1;
					content: "";
					//décalage de marge
					@decalV: (@gridBaseline*1.5 - @spriteFormat_S)/2;
					// margin: @decalV 0 0 @offS;
					left: @offS;
					top: @decalV;
					//chargement sprite entière avec dimension et SVG
					@spriteDefinition("DefaultDark"; "internet"; "search"; "S"; @spriteFormat_S; @spriteOffX-DefaultDark-internet-search; @spriteOffY-DefaultDark-internet-search);
					
					//animation apparition de la sprite
					.csstransitions.opacity & {
						opacity: 1;
						@transition(visibility, left, opacity; .05s, .2s, .2s; ease-out; .05s, .1s, .1s);
					}
				}

				//classe CSS focus ajoutée en JS
				&.focus {
					// background-color: @colorWhite;
					// .rgba & { background-color: fadeout(@colorWhite, 20%); }
					// border-color: @colorCouleur2Clair;
					
					&:before{
						//animation disparition de la sprite
						visibility: hidden;
						display: none;
						.csstransitions.opacity & {
							//on réaffiche la sprite pour gérer l'animation
							display: block;
							//replacement et disparition de la sprite
							left: @offS + @spriteFormat_S;
							// top: @gridBaseline;
							opacity: 0;

							//changement délai
							@transitionDelay(.2s, .05s, .05s);
						}
					}
				}
			}

			//masquage du label et du bouton de validation
			.label, .submit { display: none; visibility: hidden; }
			
			//champ de saisie de la recherche
			.query {
				//ajout du padding-left et width au propriétés animées par défaut
				.csstransitions & {
					@transitionProperty(margin-left, width);
					@transitionDelay(0s);
					&:focus{
						@transitionDelay(.1s);
					}
				}

				//placement et stylage de l'élément
				display: block;
				z-index: 2;
				//changement couleur et transparence du fond
				&, &:focus, &:disabled { &, .rgba & { background-color: fadeout(#00aa00, 50%); } }
				//suppression outline parasite sous webkit
				outline: 0;
				// border: 0;
				border: 1px solid purple;
				//ajustement du padding sans les bordures
				// padding: 2px @offS 2px @offS;
				padding: (@gridBaseline/4) @offS;

				//suppression des ombres internes
				.boxshadow & { &, &:focus, &:disabled { @boxShadowNone(); } }
				
				//application largeur
				&, .generatedcontent &:focus { @gridWidth(@formCol; (@offS*2 + 4px)); }

				//ajout du décalage à gauche si pseudo élément affiché
				.generatedcontent & {
					margin-left: @offS + @spriteFormat_S;
					@gridWidth(@formCol; (@offS*3 + @spriteFormat_S + 4px));

					//bordure arrondi à gauche
					// @borderRadiusCompress((@offL +1px));

					//suppression margin left lors du focus
					&:focus { margin-left: 0; }
				}

				//couleur des placeHolders
				//ciblage natif
				&::-webkit-input-placeholder { color: @colorText; text-transform: uppercase; }
				&:-moz-placeholder { color: @colorText; text-transform: uppercase; }
				//utilisé avec jQuery-placeholder
				&.placeholder { color: @colorText; text-transform: uppercase; }
			}
		}
	}
}